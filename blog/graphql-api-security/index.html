<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WCL38PDP');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Segurança de APIs GraphQL: vulnerabilidades comuns, ataques de introspecção, batching, DoS por query complexa, e melhores práticas de proteção. Guia completo para desenvolvedores e security teams.">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="keywords" content="GraphQL security, segurança GraphQL, API security, introspection attack, query batching, DoS GraphQL, rate limiting GraphQL, authorization GraphQL, OWASP API">
    <meta name="author" content="Inteligência Brasil">
    <meta name="theme-color" content="#0D1E38">
    <link rel="canonical" href="https://inteligenciabrasil.seg.br/blog/graphql-api-security/">

    <meta property="og:title" content="Segurança de APIs GraphQL: Guia Completo de Vulnerabilidades e Proteção">
    <meta property="og:description" content="Vulnerabilidades em GraphQL e como proteger suas APIs contra ataques.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://inteligenciabrasil.seg.br/blog/graphql-api-security/">
    <meta property="og:image" content="https://inteligenciabrasil.seg.br/img/og-image.png">
    <meta property="og:locale" content="pt_BR">
    <meta property="og:site_name" content="Inteligência Brasil">
    <meta property="article:published_time" content="2026-01-31T19:00:00-03:00">
    <meta property="article:section" content="AppSec">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Segurança de APIs GraphQL">
    <meta name="twitter:description" content="Guia completo de vulnerabilidades e proteção para APIs GraphQL.">

    <link rel="icon" type="image/svg+xml" href="../../img/favicon.svg">
    <link rel="shortcut icon" type="image/x-icon" href="../../img/favicon.ico">

    <title>Segurança de APIs GraphQL: Vulnerabilidades e Proteção | Inteligência Brasil</title>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Segurança de APIs GraphQL: Guia Completo de Vulnerabilidades e Proteção",
        "description": "Vulnerabilidades em GraphQL, ataques comuns e melhores práticas de segurança.",
        "image": "https://inteligenciabrasil.seg.br/img/og-image.png",
        "author": {"@type": "Organization", "name": "Inteligência Brasil"},
        "publisher": {"@type": "Organization", "name": "Inteligência Brasil", "logo": {"@type": "ImageObject", "url": "https://inteligenciabrasil.seg.br/img/logo-inteligencia-brasil-seguranca-da-informacao-cyber-security.png"}},
        "datePublished": "2026-01-31",
        "dateModified": "2026-01-31",
        "mainEntityOfPage": {"@type": "WebPage", "@id": "https://inteligenciabrasil.seg.br/blog/graphql-api-security/"}
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "GraphQL é mais seguro que REST?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Não necessariamente. GraphQL tem vulnerabilidades específicas (introspection, batching, deep queries) que REST não tem. Porém, quando bem implementado com controles adequados, GraphQL pode ser tão seguro quanto REST. A diferença está na superfície de ataque e nos controles necessários."
                }
            },
            {
                "@type": "Question",
                "name": "Devo desabilitar introspection em produção?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Sim, desabilitar introspection em produção é uma prática recomendada. Introspection expõe todo o schema da API, facilitando reconhecimento por atacantes. Em desenvolvimento e staging, mantenha habilitado para debugging. Em produção, desabilite e documente a API separadamente."
                }
            },
            {
                "@type": "Question",
                "name": "Como implementar rate limiting em GraphQL?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Rate limiting em GraphQL deve considerar complexidade da query, não apenas requisições por segundo. Use query cost analysis para calcular custo de cada query baseado em profundidade, campos e resolvers. Limite por custo total, não por número de requests. Bibliotecas como graphql-cost-analysis e graphql-query-complexity ajudam."
                }
            }
        ]
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://inteligenciabrasil.seg.br/"},
            {"@type": "ListItem", "position": 2, "name": "Blog", "item": "https://inteligenciabrasil.seg.br/blog/"},
            {"@type": "ListItem", "position": 3, "name": "GraphQL Security"}
        ]
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="../../css/bootstrap.css" rel="stylesheet">
    <link href="../../css/fontawesome-all.css" rel="stylesheet">
    <link href="../../css/styles.css" rel="stylesheet">
    <link href="../../css/servico.css" rel="stylesheet">
    <link href="../../css/blog-article.css" rel="stylesheet">
    </head>

<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WCL38PDP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="navbar navbar-expand-md navbar-dark navbar-custom fixed-top">
        <a class="navbar-brand logo-image" href="../../"><img src="../../img/logo.svg" alt="Logo Inteligência Brasil" width="196" height="113"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault"><span class="navbar-toggler-awesome fas fa-bars"></span><span class="navbar-toggler-awesome fas fa-times"></span></button>
        <div class="collapse navbar-collapse" id="navbarsExampleDefault">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a class="nav-link" href="../../">HOME</a></li>
                <li class="nav-item"><a class="nav-link" href="../../#servicos">SERVICOS</a></li>
                <li class="nav-item"><a class="nav-link active" href="../">BLOG</a></li>
                <li class="nav-item"><a class="nav-link" href="../../#contato">CONTATO</a></li>
            </ul>
            <span class="nav-item social-icons"><span class="fa-stack"><a href="https://www.linkedin.com/company/inteligenciabrasil" target="_blank" rel="noopener"><span class="hexagon"></span><i class="fab fa-linkedin-in fa-stack-1x"></i></a></span></span>
        </div>
    </nav>

    <header class="article-header">
        <div class="container">
            <span class="article-category">AppSec</span>
            <h1>Segurança de APIs GraphQL: Vulnerabilidades e Proteção</h1>
            <div class="article-meta">
                <span><i class="far fa-calendar"></i> Janeiro 2026</span>
                <span><i class="far fa-clock"></i> 20 min de leitura</span>
                <span><i class="far fa-building"></i> Inteligência Brasil</span>
            </div>
        </div>
    </header>

    <nav class="breadcrumb-nav" aria-label="breadcrumb">
        <div class="container">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../../">Home</a></li>
                <li class="breadcrumb-item"><a href="../">Blog</a></li>
                <li class="breadcrumb-item active">GraphQL Security</li>
            </ol>
        </div>
    </nav>

    <main id="main-content">
    <article class="article-content">
        <div class="container">
            <div class="article-body">
                <div class="toc">
                    <h2><i class="fas fa-list" style="color:#60A5FA"></i> Neste artigo</h2>
                    <ul>
                        <li><a href="#introducao">Por que GraphQL requer atenção especial</a></li>
                        <li><a href="#vulnerabilidades">Vulnerabilidades específicas de GraphQL</a></li>
                        <li><a href="#introspection">Ataques de Introspection</a></li>
                        <li><a href="#batching">Query Batching e Brute Force</a></li>
                        <li><a href="#dos">DoS por Query Complexity</a></li>
                        <li><a href="#authorization">Falhas de Authorization</a></li>
                        <li><a href="#injection">Injection Attacks</a></li>
                        <li><a href="#proteção">Melhores Práticas de Proteção</a></li>
                        <li><a href="#ferramentas">Ferramentas de Segurança</a></li>
                        <li><a href="#faq">Perguntas frequentes</a></li>
                    </ul>
                </div>

                <h2 id="introducao">Por que GraphQL Requer Atenção Especial</h2>

                <p>
                    <strong>GraphQL</strong> revolucionou o desenvolvimento de APIs ao permitir que clientes solicitem exatamente os dados necessários em uma única requisição. Porém, essa flexibilidade introduz vetores de ataque únicos que não existem em APIs REST tradicionais.
                </p>

                <div class="stat-highlight">
                    <div class="number">68%</div>
                    <div class="label">das APIs GraphQL em produção tem pelo menos uma vulnerabilidade crítica (Salt Security, 2025)</div>
                </div>

                <p>
                    Enquanto REST tem endpoints fixos com respostas predefinidas, GraphQL expõe um schema flexível onde o cliente controla a estrutura da query. Isso inverte o modelo de segurança tradicional e exige controles específicos.
                </p>

                <div class="concept-card">
                    <h3><i class="fas fa-exclamation-circle" style="color:#60A5FA;margin-right:10px"></i> Diferenças de segurança REST vs GraphQL</h3>
                    <ul>
                        <li><strong>REST:</strong> Endpoints fixos, fácil aplicar rate limiting por rota, WAF tradicional funciona bem</li>
                        <li><strong>GraphQL:</strong> Único endpoint, queries dinâmicas, WAF tradicional não entende o payload</li>
                        <li><strong>REST:</strong> Over-fetching e under-fetching controlados pelo servidor</li>
                        <li><strong>GraphQL:</strong> Cliente define a query, pode solicitar grafos profundos e complexos</li>
                        <li><strong>REST:</strong> Autorização por endpoint e método HTTP</li>
                        <li><strong>GraphQL:</strong> Autorização deve ser por campo e tipo no schema</li>
                    </ul>
                </div>

                <h2 id="vulnerabilidades">Vulnerabilidades Específicas de GraphQL</h2>

                <p>
                    O OWASP API Security Top 10 cobre vulnerabilidades gerais de API, mas GraphQL tem vetores adicionais que merecem atenção específica:
                </p>

                <h3>Categorias de vulnerabilidades</h3>

                <ul>
                    <li><strong>Information Disclosure:</strong> Introspection, error messages verbosos, field suggestions</li>
                    <li><strong>Denial of Service:</strong> Deep queries, circular fragments, batching abuse</li>
                    <li><strong>Broken Authorization:</strong> IDOR em mutations, field-level permissions faltando</li>
                    <li><strong>Injection:</strong> SQL injection via argumentos, NoSQL injection</li>
                    <li><strong>Authentication Bypass:</strong> Mutations sensíveis sem autenticação</li>
                </ul>

                <h2 id="introspection">Ataques de Introspection</h2>

                <p>
                    <strong>Introspection</strong> é um recurso do GraphQL que permite consultar o schema da API programaticamente. É extremamente útil em desenvolvimento, mas em produção expõe toda a superfície de ataque.
                </p>

                <div class="attack-card">
                    <h3><i class="fas fa-skull-crossbones" style="margin-right:10px"></i> Ataque: Schema Enumeration</h3>
                    <p>Atacante usa introspection para descobrir todos os tipos, campos, mutations e queries disponíveis.</p>
                    <div class="code-block">
                        <span class="comment"># Query de introspection padrão</span><br>
                        {<br>
                        &nbsp;&nbsp;__schema {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;types {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type { name }<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;mutationType {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields { name }<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <p>
                    Com o schema completo, o atacante identifica:
                </p>

                <ul>
                    <li>Campos sensíveis (ssn, creditCard, password, internalId)</li>
                    <li>Mutations administrativas (deleteUser, changeRole, resetPassword)</li>
                    <li>Relacionamentos entre tipos para escalar acesso</li>
                    <li>Campos deprecated que podem ter menos proteção</li>
                </ul>

                <div class="tip-box">
                    <h4><i class="fas fa-shield-alt" style="margin-right:10px"></i> Proteção: Desabilitar Introspection em Produção</h4>
                    <div class="code-block">
                        <span class="comment">// Apollo Server</span><br>
                        <span class="keyword">const</span> server = <span class="keyword">new</span> <span class="function">ApolloServer</span>({<br>
                        &nbsp;&nbsp;typeDefs,<br>
                        &nbsp;&nbsp;resolvers,<br>
                        &nbsp;&nbsp;introspection: process.env.NODE_ENV !== <span class="string">'production'</span><br>
                        });
                    </div>
                </div>

                <h2 id="batching">Query Batching e Brute Force</h2>

                <p>
                    GraphQL permite enviar múltiplas queries ou mutations em uma única requisição HTTP. Isso pode ser abusado para bypass de rate limiting e ataques de brute force.
                </p>

                <div class="attack-card">
                    <h3><i class="fas fa-skull-crossbones" style="margin-right:10px"></i> Ataque: Authentication Brute Force via Batching</h3>
                    <p>Em vez de 1000 requisições HTTP, atacante envia 1 requisição com 1000 mutations de login.</p>
                    <div class="code-block">
                        <span class="comment"># Uma requisição HTTP, 1000 tentativas de login</span><br>
                        [<br>
                        &nbsp;&nbsp;{"query": "mutation { login(user:\"admin\", pass:\"123456\") { token }}"},<br>
                        &nbsp;&nbsp;{"query": "mutation { login(user:\"admin\", pass:\"password\") { token }}"},<br>
                        &nbsp;&nbsp;{"query": "mutation { login(user:\"admin\", pass:\"admin123\") { token }}"},<br>
                        &nbsp;&nbsp;<span class="comment">// ... mais 997 tentativas</span><br>
                        ]
                    </div>
                </div>

                <h3>Alias Batching</h3>

                <p>
                    Mesmo sem array batching, aliases permitem executar a mesma operação múltiplas vezes:
                </p>

                <div class="code-block">
                    <span class="comment"># Brute force com aliases em uma query</span><br>
                    query {<br>
                    &nbsp;&nbsp;attempt1: login(user: "admin", pass: "123456") { token }<br>
                    &nbsp;&nbsp;attempt2: login(user: "admin", pass: "password") { token }<br>
                    &nbsp;&nbsp;attempt3: login(user: "admin", pass: "admin123") { token }<br>
                    &nbsp;&nbsp;<span class="comment"># ...</span><br>
                    }
                </div>

                <div class="tip-box">
                    <h4><i class="fas fa-shield-alt" style="margin-right:10px"></i> Proteção contra Batching</h4>
                    <ul>
                        <li>Limitar número de queries por requisição batch</li>
                        <li>Limitar número de aliases por query</li>
                        <li>Rate limiting por operação, não por requisição HTTP</li>
                        <li>Detectar e bloquear padrões de batching suspeitos</li>
                    </ul>
                </div>

                <h2 id="dos">DoS por Query Complexity</h2>

                <p>
                    A flexibilidade de GraphQL permite construir queries extremamente profundas ou circulares que consomem recursos massivos do servidor.
                </p>

                <div class="attack-card">
                    <h3><i class="fas fa-skull-crossbones" style="margin-right:10px"></i> Ataque: Deep Query DoS</h3>
                    <p>Query que explora relacionamentos para criar carga exponencial.</p>
                    <div class="code-block">
                        query DeepDoS {<br>
                        &nbsp;&nbsp;users {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;posts {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comments {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;author {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posts {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comments {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;author {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posts { <span class="comment"># contínua...</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <h3>Query Cost Analysis</h3>

                <p>
                    A solução é calcular o "custo" de cada query antes de executá-la e rejeitar queries que excedam um limite.
                </p>

                <div class="code-block">
                    <span class="comment">// Exemplo de cálculo de custo</span><br>
                    <span class="keyword">const</span> costMap = {<br>
                    &nbsp;&nbsp;User: 1,<br>
                    &nbsp;&nbsp;Post: 2,<br>
                    &nbsp;&nbsp;Comment: 1,<br>
                    &nbsp;&nbsp;posts: { multiplier: 10 }, <span class="comment">// assume 10 posts por user</span><br>
                    &nbsp;&nbsp;comments: { multiplier: 20 } <span class="comment">// assume 20 comments por post</span><br>
                    };<br><br>
                    <span class="comment">// Query acima: 1 * 10 * 20 * 1 * 10 * 20 * ... = REJEITADA</span>
                </div>

                <div class="tip-box">
                    <h4><i class="fas fa-shield-alt" style="margin-right:10px"></i> Controles de Complexidade</h4>
                    <ul>
                        <li><strong>Max depth:</strong> Limitar profundidade máxima da query (ex: 7 níveis)</li>
                        <li><strong>Query cost:</strong> Calcular custo total e limitar (ex: 1000 pontos)</li>
                        <li><strong>Timeout:</strong> Abortar queries que excedem tempo limite</li>
                        <li><strong>Pagination obrigatória:</strong> Forçar limit/offset em listas</li>
                    </ul>
                </div>

                <h2 id="authorization">Falhas de Authorization</h2>

                <p>
                    Em REST, autorização é tipicamente por endpoint. Em GraphQL, deve ser implementada no nível de campo e resolver, o que é frequentemente esquecido.
                </p>

                <div class="attack-card">
                    <h3><i class="fas fa-skull-crossbones" style="margin-right:10px"></i> Ataque: IDOR via GraphQL</h3>
                    <p>Usuario comum acessa dados de outros usuários através de IDs previsíveis.</p>
                    <div class="code-block">
                        <span class="comment"># Usuario logado com ID 123 acessa dados do usuario 456</span><br>
                        query {<br>
                        &nbsp;&nbsp;user(id: "456") {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;email<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;ssn<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;creditCards {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvv<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <h3>Field-Level Authorization</h3>

                <p>
                    Cada campo sensível deve verificar permissões no resolver:
                </p>

                <div class="code-block">
                    <span class="keyword">const</span> resolvers = {<br>
                    &nbsp;&nbsp;User: {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;ssn: (parent, args, context) => {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Apenas o próprio usuário ou admin</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (context.user.id !== parent.id && !context.user.isAdmin) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw new</span> <span class="function">ForbiddenError</span>(<span class="string">'Not authorized'</span>);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> parent.ssn;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;}<br>
                    };
                </div>

                <div class="warning-box">
                    <h4><i class="fas fa-exclamation-triangle" style="margin-right:10px"></i> Erro comum: Autorização apenas no Query Root</h4>
                    <p>Verificar autorização apenas no resolver principal não é suficiente. Atacantes podem acessar dados sensíveis através de relacionamentos:</p>
                    <div class="code-block">
                        <span class="comment"># Bypass: acessar SSN via relacionamento</span><br>
                        query {<br>
                        &nbsp;&nbsp;posts(userId: "456") { <span class="comment"># publico</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;author {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssn <span class="comment"># deveria ser protegido!</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <h2 id="injection">Injection Attacks</h2>

                <p>
                    Argumentos de queries GraphQL podem ser vetores de injection se não forem tratados adequadamente nos resolvers.
                </p>

                <div class="attack-card">
                    <h3><i class="fas fa-skull-crossbones" style="margin-right:10px"></i> Ataque: SQL Injection via GraphQL</h3>
                    <div class="code-block">
                        query {<br>
                        &nbsp;&nbsp;users(filter: "name = 'admin' OR 1=1--") {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;id<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;email<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;password_hash <span class="comment"># expoe todos os usuários</span><br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <p>
                    GraphQL não previne injection automaticamente. Resolvers que constroem queries dinâmicas são vulneráveis.
                </p>

                <div class="tip-box">
                    <h4><i class="fas fa-shield-alt" style="margin-right:10px"></i> Proteção contra Injection</h4>
                    <ul>
                        <li>Usar parametrização/prepared statements em todos os resolvers</li>
                        <li>Validar e sanitizar inputs com schema validation</li>
                        <li>Usar ORMs que escapam inputs automaticamente</li>
                        <li>Implementar allowlist de campos ordenáveis/filtráveis</li>
                    </ul>
                </div>

                <h2 id="proteção">Melhores Práticas de Proteção</h2>

                <h3>1. Configuração segura do servidor</h3>

                <div class="code-block">
                    <span class="comment">// Apollo Server com configuração segura</span><br>
                    <span class="keyword">const</span> server = <span class="keyword">new</span> <span class="function">ApolloServer</span>({<br>
                    &nbsp;&nbsp;typeDefs,<br>
                    &nbsp;&nbsp;resolvers,<br>
                    &nbsp;&nbsp;introspection: <span class="keyword">false</span>, <span class="comment">// desabilitar em produção</span><br>
                    &nbsp;&nbsp;playground: <span class="keyword">false</span>, <span class="comment">// desabilitar playground</span><br>
                    &nbsp;&nbsp;debug: <span class="keyword">false</span>, <span class="comment">// não expor stack traces</span><br>
                    &nbsp;&nbsp;validationRules: [<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="function">depthLimit</span>(7), <span class="comment">// max depth</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="function">costLimit</span>({ maxCost: 1000 })<br>
                    &nbsp;&nbsp;],<br>
                    &nbsp;&nbsp;formatError: (err) => ({<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;message: err.message <span class="comment">// não expor detalhes internos</span><br>
                    &nbsp;&nbsp;})<br>
                    });
                </div>

                <h3>2. Checklist de segurança GraphQL</h3>

                <ul>
                    <li><strong>Introspection:</strong> Desabilitado em produção</li>
                    <li><strong>Field suggestions:</strong> Desabilitado (expõe nomes de campos)</li>
                    <li><strong>Query depth:</strong> Limitado (max 7-10 níveis)</li>
                    <li><strong>Query cost:</strong> Calculado e limitado</li>
                    <li><strong>Batching:</strong> Limitado ou desabilitado</li>
                    <li><strong>Timeout:</strong> Configurado para queries</li>
                    <li><strong>Rate limiting:</strong> Por operação, não por requisição</li>
                    <li><strong>Authentication:</strong> Verificada antes de resolver queries</li>
                    <li><strong>Authorization:</strong> Implementada por campo</li>
                    <li><strong>Input validation:</strong> Em todos os argumentos</li>
                    <li><strong>Error handling:</strong> Mensagens genéricas, sem stack traces</li>
                    <li><strong>Logging:</strong> Queries, mutations e erros auditados</li>
                </ul>

                <h3>3. Persisted Queries</h3>

                <p>
                    Em vez de aceitar queries arbitrárias, aceite apenas queries pré-registradas identificadas por hash.
                </p>

                <div class="code-block">
                    <span class="comment">// Cliente envia hash em vez da query completa</span><br>
                    POST /graphql<br>
                    {<br>
                    &nbsp;&nbsp;"extensions": {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"persistedQuery": {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"sha256Hash": "abc123..."<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;}<br>
                    }<br><br>
                    <span class="comment">// Servidor executa query correspondente ao hash</span>
                </div>

                <p>
                    Isso elimina inteiramente ataques de DoS por query complexity e injection, pois queries maliciosas nunca seriam registradas.
                </p>

                <h2 id="ferramentas">Ferramentas de Segurança para GraphQL</h2>

                <h3>Análise estática e teste</h3>

                <ul>
                    <li><strong>GraphQL Cop:</strong> Auditoria automatizada de endpoints GraphQL</li>
                    <li><strong>InQL (Burp Extension):</strong> Scanner GraphQL para pentest</li>
                    <li><strong>graphql-shield:</strong> Middleware de permissões para Node.js</li>
                    <li><strong>graphql-armor:</strong> Plugin de segurança com múltiplas proteções</li>
                </ul>

                <h3>WAF e API Gateway</h3>

                <ul>
                    <li><strong>AWS AppSync:</strong> GraphQL gerenciado com controles nativos</li>
                    <li><strong>Apollo Router:</strong> Gateway com rate limiting e cost analysis</li>
                    <li><strong>Inigo:</strong> GraphQL-native security e observability</li>
                </ul>

                <h2 id="faq">Perguntas Frequentes</h2>

                <div class="faq-section">
                    <div class="faq-item">
                        <div class="faq-question">
                            <span>WAF tradicional protege GraphQL?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Parcialmente. WAFs tradicionais podem detectar payloads maliciosos genéricos (SQLi, XSS) nos argumentos, mas não entendem a semântica GraphQL. Ataques como deep queries, batching abuse e introspection passam despercebidos. Use WAF GraphQL-aware ou controles no servidor.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <span>Como fazer rate limiting efetivo em GraphQL?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Rate limiting tradicional por IP/requisição não funciona bem devido ao batching. Implemente: (1) limite por operação executada, (2) limite por custo total de query, (3) limite por usuário autenticado, (4) limite de queries batch por requisição.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <span>Persisted queries eliminam todos os riscos?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Persisted queries eliminam ataques de DoS por query complexity e injection de queries maliciosas. Porém, vulnerabilidades de autorização (IDOR), injection em argumentos e outros problemas de lógica de negócio permanecem. É uma camada importante, mas não suficiente sozinha.</p>
                        </div>
                    </div>
                </div>

                <h2 id="conclusão">Conclusão</h2>

                <p>
                    APIs GraphQL oferecem flexibilidade poderosa, mas essa flexibilidade vem com responsabilidade de segurança aumentada. A superfície de ataque é diferente de REST, e controles tradicionais não são suficientes.
                </p>

                <p>
                    Priorize: desabilitar introspection em produção, implementar query cost analysis, autorização field-level, e considerar persisted queries para ambientes de alta segurança. Teste suas APIs GraphQL com ferramentas específicas como GraphQL Cop e InQL.
                </p>

                <p>
                    A segurança de GraphQL é uma área em evolução. Mantenha-se atualizado com as recomendações do <a href="https://owasp.org" target="_blank" rel="noopener">OWASP</a> e considere GraphQL security como parte do seu programa de <a href="../sbom-software-bill-of-materials/">segurança de software</a>.
                </p>

                <div class="cta-box">
                    <h3>Precisa Avaliar a Segurança das suas APIs GraphQL?</h3>
                    <p>Oferecemos pentest especializado em GraphQL, code review e implementação de controles de segurança.</p>
                    <a href="../../#contato" class="cta-btn">Falar com Especialista</a>
                </div>

                <div class="share-buttons">
                    <span style="color:#94A3B8">Compartilhe:</span>
                    <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://inteligenciabrasil.seg.br/blog/graphql-api-security/" target="_blank" class="share-btn linkedin"><i class="fab fa-linkedin-in"></i> LinkedIn</a>
                    <a href="https://twitter.com/intent/tweet?url=https://inteligenciabrasil.seg.br/blog/graphql-api-security/&text=Segurança de APIs GraphQL" target="_blank" class="share-btn twitter"><i class="fab fa-twitter"></i> Twitter</a>
                    <a href="https://wa.me/?text=Segurança de APIs GraphQL https://inteligenciabrasil.seg.br/blog/graphql-api-security/" target="_blank" class="share-btn whatsapp"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                </div>

                <div class="author-box">
                    <picture><source type="image/webp" srcset="../../img/logo-white-140x140.webp" width="80" height="80"><img src="../../img/logo-white-140x140.png" alt="Inteligência Brasil" width="80" height="80"></picture>
                    <div class="author-info">
                        <h4><a href="https://www.linkedin.com/company/inteligenciabrasil" target="_blank" rel="noopener">Inteligência Brasil</a></h4>
                        <p>Consultoria especializada em Application Security e Segurança de APIs.</p>
                    </div>
                </div>
            </div>
        </div>
    </article>

    </main>

    <footer class="footer-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6">
                    <div class="footer-about">
                        <picture><source type="image/webp" srcset="../../img/logo-white-140x140.webp" width="140" height="140"><img src="../../img/logo-white-140x140.png" alt="Inteligência Brasil" class="footer-logo" width="140" height="140" loading="lazy"></picture>
                        <p>Consultoria especializada em Segurança, Estratégia e Tecnologia da Informação.</p>
                        <div class="footer-social">
                            <a href="https://www.linkedin.com/company/inteligenciabrasil" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                            <a href="https://www.instagram.com/inteligenciabrasiloficial/" target="_blank"><i class="fab fa-instagram"></i></a>
                            <a href="https://wa.me/message/WGB5ST6XRIOGH1" target="_blank"><i class="fab fa-whatsapp"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6">
                    <div class="footer-links">
                        <h4>Artigos Relacionados</h4>
                        <ul>
                            <li><a href="../sbom-software-bill-of-materials/">SBOM</a></li>
                            <li><a href="../seguranca-llm-genai-prompt-injection/">LLM Security</a></li>
                            <li><a href="../detection-engineering-regras-deteccao/">Detection Engineering</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6">
                    <div class="footer-links">
                        <h4>Navegação</h4>
                        <ul>
                            <li><a href="../../">Home</a></li>
                            <li><a href="../../#servicos">Serviços</a></li>
                            <li><a href="../">Blog</a></li>
                            <li><a href="../../#contato">Contato</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="footer-contact">
                        <h4>Contato</h4>
                        <p><i class="fas fa-map-marker-alt"></i> Av. Paulista 807, São Paulo - SP</p>
                        <p><i class="fas fa-phone"></i> +55 (11) 99361-9947</p>
                        <p><i class="fas fa-envelope"></i> contato@inteligenciabrasil.seg.br</p>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="row align-items-center">
                    <div class="col-md-6"><p>&copy; 2026 Inteligência Brasil. Todos os direitos reservados.</p></div>
                    <div class="col-md-6 text-md-right">
                        <a href="../../politica-de-privacidade.html">Política de Privacidade</a>
                        <span class="separator">|</span>
                        <a href="../../#contato">Contato</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- WhatsApp Float -->
    <div class="whatsapp-float">
        <a href="https://wa.me/message/WGB5ST6XRIOGH1" target="_blank" aria-label="Fale conosco no WhatsApp">
            <i class="fab fa-whatsapp"></i>
        </a>
    </div>

    <!-- Back to Top -->
    <a href="#" class="back-to-top" aria-label="Voltar ao topo">
        <i class="fas fa-chevron-up"></i>
    </a>
    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/popper.min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/jquery.easing.min.js"></script>
    <script>

        // Back to Top
        (function() {
            var backToTop = document.querySelector('.back-to-top');
            if (backToTop) {
                window.addEventListener('scroll', function() {
                    if (window.pageYOffset > 300) {
                        backToTop.style.display = 'flex';
                    } else {
                        backToTop.style.display = 'none';
                    }
                });
                backToTop.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }
        })();

                $(window).on('scroll load',function(){$('.navbar').offset().top>20?$('.navbar-custom').addClass('top-nav-collapse'):$('.navbar-custom').removeClass('top-nav-collapse')});
        $('a[href^="#"]').on('click',function(e){e.preventDefault();var t=$(this.getAttribute('href'));t.length&&$('html, body').animate({scrollTop:t.offset().top-100},500,'easeInOutExpo')});
        document.querySelectorAll('.faq-question').forEach(function(q){q.addEventListener('click',function(){this.parentElement.classList.toggle('active')})});
    </script>
</body>
</html>
